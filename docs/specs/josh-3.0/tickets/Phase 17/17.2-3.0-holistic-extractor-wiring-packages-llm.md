# Ticket 17.2 — 3.0 Holistic Extractor Wiring (packages/llm) (M)

## Role
Principal Systems Architect & Full-Stack Engineer (TypeScript, LLM schema contracts, Zod, monorepo package boundaries)

## Phase
Phase 17 — Type System And Eligibility Layer

## Complexity
M

## What This Ticket Builds
Replaces step-based interview extraction wiring in `packages/llm` with the new holistic extraction contracts from `@josh/db`, and ensures `packages/llm` exports a holistic extractor interface aligned with:

- `HolisticExtractInput`
- `HolisticExtractOutput`

## Why It Matters
Phase 17 standardizes extraction around a holistic profile update model. `packages/llm` must consume the new types and schemas so downstream conversation engines can call one extractor consistently, without per-step extraction drift.

## Behavioral Constraints
- No database schema changes.
- No migrations.
- No conversation routing changes.
- Keep changes scoped to `packages/llm` and any required type import adjustments.
- Additive changes only; legacy step-based extraction may be deprecated but not deleted unless explicitly required.
- No prompt/behavior changes beyond schema/type alignment.

## Schema Changes
None.

## Runtime Changes
Limited to extraction type/schema wiring. No changes to orchestration logic outside of `packages/llm`.

## Dependencies
- Ticket 17.1 merged:
  - `@josh/db` exports `HolisticExtractInput`, `HolisticExtractOutput`, `CoordinationDimensions`, `CoordinationSignals`, `DimensionCoverageSummary`
  - Legacy interview extraction types are deprecated aliases

## Deliverables
1. Update `packages/llm` to use holistic extraction types from `@josh/db` instead of:
   - `InterviewExtractInput`
   - `InterviewExtractOutput`
2. Add/Update schemas in `packages/llm` as needed so the extractor output validates:
   - `coordinationDimensionUpdates`
   - `coordinationSignalUpdates`
   - `coverageSummary: DimensionCoverageSummary`
   - `needsFollowUp: boolean`
3. Deprecate (do not delete yet) any step-based extractor entrypoints if they exist, pointing to the holistic extractor.
4. Add a unit test in `packages/llm` that:
   - imports the holistic extractor types
   - validates the schema accepts a minimal valid `HolisticExtractOutput`

## Verification Checklist
- `pnpm typecheck` passes repo-wide
- `pnpm lint` passes repo-wide
- `packages/llm` unit tests pass
- Ensure no references remain to the old per-step extraction types in `packages/llm` except deprecated shims (if required)

## Completion Criteria
Ticket is complete when:
- `packages/llm` compiles against the holistic extraction contracts from `@josh/db`
- Schemas validate holistic output shape
- Tests pass (excluding known existing failures on main, if still present)
- Changes are committed and pushed on:
  - `ticket/17.2-3.0-holistic-extractor-wiring-packages-llm`
- Final summary lists EVERY created/changed file with FULL repo-relative paths.
